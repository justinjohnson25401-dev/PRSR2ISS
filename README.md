# 2GIS Parser Pro v2.3.8

## Что это такое

**2GIS Parser Pro** — это расширение для браузера Chrome, которое автоматически собирает контактные данные компаний с сайта 2GIS.ru и экспортирует их в Excel-файлы.

Это **инструмент для сбора баз данных**, которые затем продаются через **Telegram-бот** (проект TGBOTFORPARSINGG).

---

## Связь с Telegram-ботом

```
┌─────────────────────┐     XLSX файлы      ┌─────────────────────┐
│                     │ ─────────────────►  │                     │
│   2GIS Parser Pro   │                     │   Telegram Bot      │
│   (этот проект)     │   Категория_Город   │   (TGBOTFORPARSINGG)│
│                     │   _ПакетN_Дата.xlsx │                     │
└─────────────────────┘                     └─────────────────────┘
     Сбор данных                               Продажа баз
```

**Парсер создает товар → Бот его продает**

---

## Какие данные собирает парсер

Для каждой компании из 2GIS собираются:

| Поле | Описание | Пример |
|------|----------|--------|
| Название | Имя компании | "Сияй" |
| Категория | Тип бизнеса | "Салон красоты" |
| Специализация | Детали услуг | "Сложное окрашивание" |
| Адрес | Полный адрес с городом | "Москва, ул. Ленина, 15" |
| Расст. от центра | Километры от центра города | 5.2 |
| Зона | Географическая зона | "Срединная зона" |
| Телефоны | Нормализованные номера | "+79161234567, +79261234567" |
| Email | Электронная почта | "info@salon.ru" |
| Сайт | URL сайта | "https://salon.ru" |
| Telegram | Ссылка на Telegram | "https://t.me/salon" |
| Telegram username | Username | "@salon" |
| VK | Ссылка на VKontakte | "https://vk.com/salon" |
| WhatsApp | Ссылка на WhatsApp | "https://wa.me/79161234567" |
| Рейтинг | Оценка 0-5 | 4.8 |
| Оценок | Количество оценок | 156 |
| Отзывов | Количество отзывов | 89 |
| График работы | Часы работы | "пн-пт 10:00-20:00" |
| Координаты | Широта и долгота | 55.7558, 37.6173 |
| Ссылка 2ГИС | Кликабельная ссылка на карту | [2ГИС] |
| Ссылка Яндекс | Кликабельная ссылка на карту | [Яндекс] |
| Дата сбора | Когда собраны данные | "08.01.2026" |

---

## Зоны города

Парсер автоматически определяет **зону** компании по расстоянию от центра города:

| Зона | Расстояние | Цвет в Excel |
|------|------------|--------------|
| Центр | 0-5 км | Голубой |
| Срединная зона | 5-15 км | Зеленый |
| Спальный район | 15-30 км | Оранжевый |
| Окраина | >30 км | Красный |

**Почему это важно для бота:** Покупатели баз часто хотят компании из определенных зон (например, только центр для премиум-услуг).

---

## Формат выходных файлов

### Имя файла
```
{Категория}_{Город}_Пакет{N}_{YYYY-MM-DD}.xlsx
```

**Примеры:**
- `Салоны красоты_Москва_2026-01-08.xlsx` (один файл)
- `Салоны красоты_Москва_Пакет1_2026-01-08.xlsx` (если разбито на пакеты)
- `Салоны красоты_Москва_Пакет2_2026-01-08.xlsx`

### Структура файла

**Строка 1:** Статистика по зонам
```
Статистика по зонам: Центр: 150 | Срединная зона: 320 | Спальный район: 400 | Окраина: 130
```

**Строка 2:** Заголовки столбцов

**Строки 3+:** Данные компаний

---

## Ключевые функции v2.3.8

### 1. Автоматический сбор страниц
- Парсер сам переключает страницы на 2GIS каждые 10 секунд
- Собирает все результаты поиска автоматически

### 2. Удаление дубликатов
- Если у двух компаний **одинаковый телефон** → дубликат удаляется
- Если у двух компаний **одинаковый Telegram** → дубликат удаляется
- Это гарантирует уникальность контактов в базе

### 3. Разбиение на пакеты
- По умолчанию: **1000 записей** на файл
- Можно настроить: от 100 до 50000 записей
- Если собрано 3500 записей → создается 4 файла (1000+1000+1000+500)

### 4. Фильтрация
- Только с мобильными телефонами (+79...)
- Только с Telegram
- Только с email
- Только с сайтом
- По минимальному рейтингу (например, от 4.0)

### 5. Нормализация телефонов
- `8-916-123-45-67` → `+79161234567`
- `(495) 123-45-67` → `+74951234567`
- Все телефоны в едином формате для удобства обзвона

---

## Поддерживаемые города

Москва, Санкт-Петербург, Новосибирск, Екатеринбург, Казань, Нижний Новгород, Челябинск, Самара, Омск, Ростов-на-Дону, Уфа, Красноярск, Воронеж, Пермь, Волгоград

**Спецзаказ:** Можно вручную ввести любой другой город.

---

## Как это использовать в Telegram-боте

### Процесс работы:

1. **Оператор** запускает парсер на нужную категорию (например, "Салоны красоты Москва")
2. **Парсер** собирает данные и создает XLSX файлы
3. **Оператор/Админ** загружает файлы в Telegram-бот
4. **Бот** нарезает базу на пакеты для продажи (1000/2000/3000/5000 контактов)
5. **Покупатель** выбирает город, категорию, размер пакета и оплачивает
6. **Бот** отправляет XLSX файл покупателю

### Рекомендации для бота:

**1. Парсинг имени файла:**
```
Файл: "Салоны красоты_Москва_Пакет1_2026-01-08.xlsx"
       ↓
Категория: "Салоны красоты"
Город: "Москва"
Пакет: 1
Дата: 2026-01-08
```

**2. Чтение статистики зон:**
Первая строка файла содержит статистику — показывать покупателю для оценки качества базы.

**3. Ценообразование по размеру:**
| Контактов | Рекомендуемая цена |
|-----------|-------------------|
| 1000 | 8 000 ₽ |
| 2000 | 15 000 ₽ |
| 3000 | 21 000 ₽ |
| 5000 | 30 000 ₽ |

**4. Хранение баз:**
- Загружать файлы на Google Drive
- Хранить в БД: город, категория, количество записей, дата, ссылка на файл

---

## Технические детали

- **Платформа:** Chrome Extension (Manifest v3)
- **Формат экспорта:** XLSX (Excel), CSV, JSON
- **Библиотека Excel:** SheetJS
- **Хранение данных:** chrome.storage.local
- **Лимит хранения:** ~5MB (~3000-5000 записей)

---

## Версионность

| Версия | Дата | Изменения |
|--------|------|-----------|
| 2.3.8 | 08.01.2026 | Добавлено: категория, спецзаказ, удаление дубликатов, разбиение на пакеты, статистика зон, дата сбора |
| 2.3.7 | 07.01.2026 | Фиксированный интервал 10 сек между страницами |
| 2.3.6 | 06.01.2026 | Исправления автосбора |

---

## Контакты

- **Поддержка:** https://t.me/aza_support
- **Репозиторий:** PRSR2ISS

---

*Этот документ предназначен для интеграции с проектом Telegram-бота (TGBOTFORPARSINGG). При обновлении парсера — обновляйте этот README.*
